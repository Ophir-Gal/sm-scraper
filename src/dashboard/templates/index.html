<!DOCTYPE html>
<meta charset="utf-8" />

<head>
<title>Reddit Police Brutality Dashboard</title>

<script src="https://d3js.org/d3.v6.min.js"></script>
<script src="https://unpkg.com/d3-simple-slider"></script>
<link type="text/css" rel="stylesheet"
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="{{ url_for('static',filename='css/style.css') }}">
<link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
</head>

<body  class="bg-light">
  <div class="container-fluid px-4 h-100">
  <div class="mb-4 mt-4">
    <h3>CMSC828D: Reddit Police Brutality Activity Dashboard</h3>
  </div>

  <div class="row">
    <div class="col-2 container-fluid h-100">
      <div class="mb-2 p-2 pb-4 rounded shadow-1-strong bg-white list-item" id="query-box">        
        <div class="col-title">
          Query Filters
        </div>
        <form>
<<<<<<< HEAD
          <input class="input-width" type="text" id="search" name="search" placeholder="Keyword Search">
=======
          <input type="text" id="fname" name="fname">
          <input type="text" id="fname" name="fname">
          <input type="text" id="fname" name="fname">
          <input type="text" id="fname" name="fname">
>>>>>>> parent of d6ee07d... implemented dynamic post list loading, still awaiting data
        </form>
      </div>
    </div>

    <div class="col-10 container-fluid">
      <div class="mb-4 container-fluid">
        <div class="row">
          <div class="col-3 p-0 pr-2 container-fluid h-100">
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white list-item" id="stat1">
              Stat1
            </div>
          </div>
          <div class="col-3 p-0 pr-2 container-fluid h-100">
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white list-item" id="stat2">
              Stat2
            </div>
          </div>
          <div class="col-3 p-0 pr-2 container-fluid h-100">
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white list-item" id="stat3">
              Stat3
            </div>
          </div>
          <div class="col-3 p-0 container-fluid h-100">
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white list-item" id="stat4">
              Stat4
            </div>
          </div>
          
        </div>
        
      </div>
      <div class="row">
        <div class="col-6 container-fluid">
          <div class="col-title">
            Reddit Posts
          </div>
          <div class="overflow-auto" style="max-height: 750px;">
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white" id="boxplot-vis">
              <div class="mb-1">Reddit Post 1</div>
              <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed in magna nisl. Nunc convallis et risus id varius. Aliquam elit quam, hendrerit nec urna sit amet, iaculis pulvinar elit. Phasellus vel pharetra orci. Sed vel ante consequat nisl commodo scelerisque. Suspendisse feugiat magna ac metus aliquet rutrum.</div>
            </div>
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white" id="boxplot-vis">
              <div class="mb-1">Reddit Post 2</div>
              <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed in magna nisl. Nunc convallis et risus id varius. Aliquam elit quam, hendrerit nec urna sit amet, iaculis pulvinar elit. Phasellus vel pharetra orci. Sed vel ante consequat nisl commodo scelerisque. Suspendisse feugiat magna ac metus aliquet rutrum.</div>
            </div>
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white" id="boxplot-vis">
              <div class="mb-1">Reddit Post 3</div>
              <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed in magna nisl. Nunc convallis et risus id varius. Aliquam elit quam, hendrerit nec urna sit amet, iaculis pulvinar elit. Phasellus vel pharetra orci. Sed vel ante consequat nisl commodo scelerisque. Suspendisse feugiat magna ac metus aliquet rutrum.</div>
            </div>
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white" id="boxplot-vis">
              <div class="mb-1">Reddit Post 4</div>
              <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed in magna nisl. Nunc convallis et risus id varius. Aliquam elit quam, hendrerit nec urna sit amet, iaculis pulvinar elit. Phasellus vel pharetra orci. Sed vel ante consequat nisl commodo scelerisque. Suspendisse feugiat magna ac metus aliquet rutrum.</div>
            </div>
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white" id="boxplot-vis">
              <div class="mb-1">Reddit Post 5</div>
              <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed in magna nisl. Nunc convallis et risus id varius. Aliquam elit quam, hendrerit nec urna sit amet, iaculis pulvinar elit. Phasellus vel pharetra orci. Sed vel ante consequat nisl commodo scelerisque. Suspendisse feugiat magna ac metus aliquet rutrum.</div>
            </div>
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white" id="boxplot-vis">
              <div class="mb-1">Reddit Post 6</div>
              <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed in magna nisl. Nunc convallis et risus id varius. Aliquam elit quam, hendrerit nec urna sit amet, iaculis pulvinar elit. Phasellus vel pharetra orci. Sed vel ante consequat nisl commodo scelerisque. Suspendisse feugiat magna ac metus aliquet rutrum.</div>
            </div>
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white" id="boxplot-vis">
              <div class="mb-1">Reddit Post 7 last</div>
              <div>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed in magna nisl. Nunc convallis et risus id varius. Aliquam elit quam, hendrerit nec urna sit amet, iaculis pulvinar elit. Phasellus vel pharetra orci. Sed vel ante consequat nisl commodo scelerisque. Suspendisse feugiat magna ac metus aliquet rutrum.</div>
            </div>
          </div>
        
        </div>

        <div class="col-6 container-fluid">
          <div class="col-title">
            Visualizations
          </div>
          <div class="mb-3 p-2 rounded shadow-1-strong bg-white" id="boxplot-vis">
            Vis 1
          </div>
          <div class="mb-3 p-2 rounded shadow-1-strong bg-white" id="boxplot-vis">
            Vis 2
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
<<<<<<< HEAD
  var sampleText = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed in magna nisl. Nunc convallis et risus id varius. Aliquam elit quam, hendrerit nec urna sit amet, iaculis pulvinar elit. Phasellus vel pharetra orci. Sed vel ante consequat nisl commodo scelerisque. Suspendisse feugiat magna ac metus aliquet rutrum.";
  var postList = [];

  // on input change, requery data and reload viz
  function updateData() {
    // request here?
  }
  
  // Render all visualizations (the function needs to have global scope)
  function renderAll(
    scatterplot = true,
    postlist = true,
    filters = {}
  ) {
    console.log("Rendering all");
    //if (scatterplot) render_scatterplot(filters)
    if (postlist) renderPostList()
  }

  window.addEventListener('load', renderAll)
  window.addEventListener('resize', renderAll)

  function renderPostList() {
    if (postList.length == 0) { // for testing without data!
      postList = [{'title': 'Post 1', 'body': sampleText},{'title': 'Post 2', 'body': sampleText},{'title': 'Post 3', 'body': sampleText}];
    }
    var listNode = document.getElementById("postlist");
    // clears existing list items
    while (listNode.firstChild) {
      listNode.removeChild(listNode.firstChild);
    }
    // build list item and append for each post
    postList.forEach(post => {
      var node = document.createElement("div"); 
      node.classList.add("mb-2", "p-2", "rounded", "shadow-1-strong", "bg-white");

      var titleNode = document.createElement("div");
      titleNode.classList.add("mb-1");
      var textNode = document.createTextNode(post.title);
      titleNode.appendChild(textNode);  
      node.appendChild(titleNode);

      var titleNode = document.createElement("div");
      var textNode = document.createTextNode(post.body);
      titleNode.appendChild(textNode);  
      node.appendChild(titleNode);

      listNode.appendChild(node);
    });
  }

=======
  
>>>>>>> parent of d6ee07d... implemented dynamic post list loading, still awaiting data
  // initial creation of the ...
  //init();

  // fetch enables GET and POST requests to the server (run using server.py)
  let url = new URL("http://localhost:8000/get-data");
  let reqStateUrl = new URL("http://localhost:8000/get-state");

  reqStateUrl.search = new URLSearchParams({}).toString();
  fetch(reqStateUrl,{"credentials": "same-origin"})
  .then(response => response.json())
  .then(obj => {
    console.log(obj);
    let reqState = obj
    url.search = new URLSearchParams({"reqState": reqState}).toString();
    fetch(url,{"credentials": "same-origin"})
    .then(response => response.json())
    .then(obj => {
      let data = obj['data']
      console.log("data: ", data)
      renderAll();
    });
  });
</script>
</body>