<!DOCTYPE html>
<meta charset="utf-8" />

<head>
<title>Reddit Police Brutality Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://d3js.org/d3.v6.min.js"></script>
<script src="https://unpkg.com/d3-simple-slider"></script>
<link type="text/css" rel="stylesheet"
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<link rel="stylesheet" href="{{ url_for('static',filename='css/style.css') }}">
<link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico')
}}">
<script src="{{ url_for('static', filename='js/util.js') }}"></script>
<script src="{{ url_for('static', filename='js/keyword-input.js') }}"></script>
<script src="{{ url_for('static', filename='js/post-list.js') }}"></script>
<script src="{{ url_for('static', filename='js/times-vis.js') }}"></script>
<script src="{{ url_for('static', filename='js/words-vis.js') }}"></script>
</head>

<body  class="bg-light">
  <div class="container-fluid px-4 h-100">
  <div class="mb-4 mt-4">
    <h3>CMSC828D: Reddit Police Brutality Activity Dashboard</h3>
  </div>

  <div class="row">
    <div class="col-2 container-fluid h-100">
      <div class="mb-2 p-2 pb-4 rounded shadow-1-strong bg-white list-item" id="query-box">        
        <div class="col-title">
          Query Filters
        </div>
        <input class="mb-1 input-width" type="text" id="keyword-input" name="keyword-input" placeholder="Keyword Input">
        <div id="keyword-pill-list"></div>
        <div id="date-range-slider">Date range slider</div>
      </div>
    </div>

    <div class="col-10 container-fluid">
      <div class="mb-4 container-fluid">
        <div class="row">
          <div class="col-3 p-0 pr-2 container-fluid h-100">
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white list-item" id="stat1">
              Stat1
            </div>
          </div>
          <div class="col-3 p-0 pr-2 container-fluid h-100">
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white list-item" id="stat2">
              Stat2
            </div>
          </div>
          <div class="col-3 p-0 pr-2 container-fluid h-100">
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white list-item" id="stat3">
              Stat3
            </div>
          </div>
          <div class="col-3 p-0 container-fluid h-100">
            <div class="mb-2 p-2 rounded shadow-1-strong bg-white list-item" id="stat4">
              Stat4
            </div>
          </div>
          
        </div>
        
      </div>
      <div class="row">
        <div class="col-6 container-fluid" style="max-height: 65vh;">
          <div class="col-title">
            Reddit Posts
          </div>
          <div class="pl-1 pr-1 overflow-auto" id="postlist" style="max-height: 65vh;">
            
          </div>
        </div>

        <div class="col-6 container-fluid">
          <div class="col-title">
            Visualizations
          </div>
          <div class="mb-3 p-2 rounded shadow-1-strong bg-white" id="times-vis" style="height: 43%">   
          </div>
          <div class="mb-3 p-2 rounded shadow-1-strong bg-white" id="words-vis" style="height: 43%">
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
  var postList = [];
  var keywords = [];
  
  // Render all visualizations (the function needs to have global scope)
  function renderAll(
    times_vis = true,
    words_vis = true,
    postlist = true,
    filters = {}
  ) {
    console.log("Rendering all");
    if (times_vis) render_times_vis(filters)
    if (words_vis) render_words_vis(filters)
    if (postlist) renderPostList()
  }

  window.addEventListener('load', renderAll)
  window.addEventListener('resize', renderAll)

  // add keyword pills
  document.getElementById("keyword-input").addEventListener("keydown", function (e) {
      if (e.keyCode === 13) {
          addKeywords(e);
      }
  });
</script>
</body>
